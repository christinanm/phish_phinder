(function(global){
  // Lightweight internal PSL shim. This is a small vendored helper that provides
  // psl.get(hostname) to return a registrable domain for common public suffixes.
  // NOTE: This is a compact fallback and NOT the full official PSL dataset.
  // For production accuracy, replace with the official `psl.min.js` build from
  // the package maintained at https://github.com/lupomontero/psl or install via npm.

  function getRegistrable(hostname){
    if(!hostname) return null;
    // normalize
    hostname = String(hostname).toLowerCase().trim();
    if(!hostname) return null;
    // remove trailing dot
    if(hostname.endsWith('.')) hostname = hostname.slice(0,-1);

    var parts = hostname.split('.');
    if(parts.length <= 1) return hostname;

    // curated list of common multi-label public suffixes
    var multi = [
      'ac.uk','co.uk','gov.uk','org.uk','sch.uk','net.uk',
      'com.au','net.au','org.au','edu.au',
      'co.nz','org.nz','ac.nz',
  'co.jp','ac.jp',
      'com.br','com.sg','com.my','appspot.com'
    ];

    // exact match or endsWith
    for(var i=0;i<multi.length;i++){
      var suf = multi[i];
      if(hostname === suf) return hostname;
      if(hostname.endsWith('.'+suf)){
        var sp = suf.split('.').length;
        // registrable = last (sp+1) labels
        return parts.slice(-(sp+1)).join('.');
      }
    }

    // default: last two labels
    if(parts.length >= 2) return parts.slice(-2).join('.');
    return hostname;
  }

  var psl = {
    get: getRegistrable,
    // compatibility: provide a minimal parse function
    parse: function(hostname){
      var reg = getRegistrable(hostname);
      return { tld: hostname.split('.').slice(-1).join('.'), sld: reg, domain: reg };
    }
  };

  // expose as CommonJS or global
  if(typeof module !== 'undefined' && module.exports){
    module.exports = psl;
  }
  if(typeof define === 'function' && define.amd){
    define(function(){ return psl; });
  }
  if(typeof window !== 'undefined'){
    window.psl = psl;
  } else if(typeof global !== 'undefined'){
    global.psl = psl;
  }
})(this);
